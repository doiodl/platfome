{"ast":null,"code":"import _classCallCheck from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/timurzajnullin/Desktop/translation_web/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import connect from'@vkontakte/vk-connect';import{platform,IOS}from'@vkontakte/vkui';import Panel from'@vkontakte/vkui/dist/components/Panel/Panel';import PanelHeader from'@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';import HeaderButton from'@vkontakte/vkui/dist/components/HeaderButton/HeaderButton';import Group from'@vkontakte/vkui/dist/components/Group/Group';import Div from'@vkontakte/vkui/dist/components/Div/Div';import Textarea from'@vkontakte/vkui/dist/components/Textarea/Textarea';import Button from'@vkontakte/vkui/dist/components/Button/Button';import Icon28ChevronBack from'@vkontakte/icons/dist/28/chevron_back';import Icon24Back from'@vkontakte/icons/dist/24/back';import $ from'jquery';import persik from'../img/persik.png';import'youtube-video-js';import YouTubePlayer from'react-player/lib/players/YouTube';import'./Persik.css';import Icon28Send from'@vkontakte/icons/dist/28/send';import{FormLayout,FormLayoutGroup,Input}from'@vkontakte/vkui';var Chat=/*#__PURE__*/function(_Component){_inherits(Chat,_Component);function Chat(props){var _this;_classCallCheck(this,Chat);_this=_possibleConstructorReturn(this,_getPrototypeOf(Chat).call(this,props));_this.infoId=props;_this.but=_this.but.bind(_assertThisInitialized(_this));_this.onChangeHandler=_this.onChangeHandler.bind(_assertThisInitialized(_this));_this.state={massive:[],cur_n:0,msg:\"\"};return _this;}_createClass(Chat,[{key:\"but\",value:function but(e){e.preventDefault();console.log('По ссылке кликнули.');console.log(this.props.fetchedUser);var date=new Date();var user={type_req:'chat',object:{type:\"post\",info:{'id':this.props.fetchedUser.id,'name':this.props.fetchedUser.first_name+\" \"+this.props.fetchedUser.last_name,'msg':$(\"#message-text\").val(),\"date_msg\":date.getHours().toString(10)+\":\"+date.getMinutes().toString(10)}}};this.setState({msg:\"\"});fetch('https://doiodl.pythonanywhere.com/',{method:'POST',headers:{'Content-Type':'application/json;charset=utf-8'},body:JSON.stringify(user)});}},{key:\"tick\",value:function tick(e){var user={type_req:'chat',object:{type:\"get\",current_msg:this.state.cur_n}};fetch('https://doiodl.pythonanywhere.com/',{method:'POST',headers:{'Content-Type':'application/json;charset=utf-8'},body:JSON.stringify(user)}).then(function(response){return response.json();}).then(function(data){console.log(data);if(data['add']){console.log(data['msg_arr']);var m=e.state.massive;e.setState({massive:m.concat(data['msg_arr'])});e.setState({cur_n:e.state.massive.length});}});}},{key:\"onChangeHandler\",value:function onChangeHandler(event){var value=event.target.value;this.setState({msg:value});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;setInterval(function(){return _this2.tick(_this2);},3000);}},{key:\"render\",value:function render(){return React.createElement(Group,{name:\"chats\"},React.createElement(Div,{className:\"pole\",style:{height:\"250px\",maxHeight:\"250px\"}},this.state.massive.map(function(element,i){return React.createElement(\"div\",null,\" \",element.name,\" \");// return $(\".pole\").append(\"<spand></spand>\");\n})),React.createElement(Div,{class:\"chat-input\"},React.createElement(FormLayout,{id:\"chat-form\"},React.createElement(\"div\",{style:{display:\"flex\",width:\"100%\"}},React.createElement(Textarea,{style:{width:\"90%\"},id:\"message-text\",onChange:this.onChangeHandler,class:\"chat-form__input\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",value:this.state.msg}),React.createElement(Button,{style:{height:\"40px\"},before:React.createElement(Icon28Send,null),class:\"chat-form__submit\",onClick:this.but})))));}}]);return Chat;}(Component);export default Chat;","map":{"version":3,"sources":["/Users/timurzajnullin/Desktop/translation_web/src/panels/Chat.js"],"names":["React","Component","connect","platform","IOS","Panel","PanelHeader","HeaderButton","Group","Div","Textarea","Button","Icon28ChevronBack","Icon24Back","$","persik","YouTubePlayer","Icon28Send","FormLayout","FormLayoutGroup","Input","Chat","props","infoId","but","bind","onChangeHandler","state","massive","cur_n","msg","e","preventDefault","console","log","fetchedUser","date","Date","user","type_req","object","type","info","id","first_name","last_name","val","getHours","toString","getMinutes","setState","fetch","method","headers","body","JSON","stringify","current_msg","then","response","json","data","m","concat","length","event","value","target","setInterval","tick","height","maxHeight","map","element","i","name","display","width"],"mappings":"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","sourcesContent":["import React, { Component} from 'react';\nimport PropTypes from 'prop-types';\nimport connect from '@vkontakte/vk-connect';\nimport { platform, IOS } from '@vkontakte/vkui';\nimport Panel from '@vkontakte/vkui/dist/components/Panel/Panel';\nimport PanelHeader from '@vkontakte/vkui/dist/components/PanelHeader/PanelHeader';\nimport HeaderButton from '@vkontakte/vkui/dist/components/HeaderButton/HeaderButton';\nimport Group from '@vkontakte/vkui/dist/components/Group/Group';\nimport Div from '@vkontakte/vkui/dist/components/Div/Div';\nimport Textarea from '@vkontakte/vkui/dist/components/Textarea/Textarea';\n\nimport Button from '@vkontakte/vkui/dist/components/Button/Button';\nimport Icon28ChevronBack from '@vkontakte/icons/dist/28/chevron_back';\nimport Icon24Back from '@vkontakte/icons/dist/24/back';\nimport $ from 'jquery';\nimport persik from '../img/persik.png';\nimport 'youtube-video-js';\nimport YouTubePlayer from 'react-player/lib/players/YouTube';\nimport './Persik.css';\nimport Icon28Send from '@vkontakte/icons/dist/28/send';\nimport { FormLayout, FormLayoutGroup, Input } from '@vkontakte/vkui';\n\nclass Chat extends Component {\n    constructor(props) {\n      super(props);\n      this.infoId = props;\n      this.but = this.but.bind(this)\n      this.onChangeHandler = this.onChangeHandler.bind(this)\n      this.state = {\n        massive: [],\n        cur_n: 0,\n        msg:\"\"\n      };\n    }\n  \n  but(e) {\n    e.preventDefault();\n    console.log('По ссылке кликнули.');\n    console.log(this.props.fetchedUser)\n    var date = new Date();\n    let user = {\n      type_req: 'chat',\n      object: {\n        type: \"post\",\n        info: {\n          'id': this.props.fetchedUser.id,\n          'name': this.props.fetchedUser.first_name + \" \" + this.props.fetchedUser.last_name,\n          'msg': $(\"#message-text\").val(),\n          \"date_msg\": date.getHours().toString(10) +\":\"+ date.getMinutes().toString(10)\n        }\n\t\t\t}\n    };\n    this.setState({\n      msg: \"\"\n  })\n    fetch('https://doiodl.pythonanywhere.com/', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8'\n\t\t\t},\n\t\t\tbody: JSON.stringify(user)\n      })\n  }\n  tick(e)\n  {\n    let user = {\n\t\t\ttype_req: 'chat',\n      object: {\n        type: \"get\",\n        current_msg: this.state.cur_n\n\t\t\t}\n\t\t};\n\t\tfetch('https://doiodl.pythonanywhere.com/', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json;charset=utf-8'\n\t\t\t},\n\t\t\tbody: JSON.stringify(user)\n      })\n      .then(function (response) {\n        return response.json();\n      })\n      .then(function (data) {\n        console.log(data)\n        if (data['add'])\n        {\n          console.log(data['msg_arr'])\n          var m = e.state.massive;\n          e.setState({\n            massive: m.concat(data['msg_arr'])\n          });\n          e.setState({\n            cur_n: e.state.massive.length\n          });\n        }\n\t\t  });\n  }\n  onChangeHandler(event){       \n    const value = event.target.value;\n    this.setState({\n        msg: value\n    })\n}\n  componentDidMount() {\n    setInterval(() => this.tick(this), 3000);\n  }\n    render(){\n        return (\n          <Group name=\"chats\">\n            <Div className=\"pole\" style={{ height: \"250px\", maxHeight: \"250px\"}}>\n              {this.state.massive.map((element, i) => {\n                return <div> {element.name} </div>;\n                // return $(\".pole\").append(\"<spand></spand>\");\n              })}\n            </Div> \n            <Div class='chat-input' >\n              <FormLayout id='chat-form' >\n                <div style={{ display: \"flex\", width: \"100%\"}}>\n            <Textarea style={{ width: \"90%\" }} id='message-text' onChange={this.onChangeHandler}\n            class='chat-form__input' placeholder='Введите сообщение'  value={this.state.msg} />\n                <Button style={{ height: \"40px\" }} before={<Icon28Send />} class='chat-form__submit' onClick={this.but} ></Button>\n                </div>\n              </FormLayout>\n\t\t\t\t    </Div>\n          </Group>\n        );\n    }\n    \n\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}